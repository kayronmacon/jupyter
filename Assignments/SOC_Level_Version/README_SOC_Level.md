# SOC-Level Version – Advanced Detection Scenarios

This version includes:
- Multi-stage brute force (AUTH_FAIL burst → AUTH_SUCCESS)
- Post-compromise actions (PRIV_ESCALATION, DATA_EXPORT)
- Impossible travel (same user authenticates from two distant locations too quickly)

## Files
- `soc_auth_activity_advanced.csv` — advanced dataset with geo fields and injected attack scenarios
- `SOC_Level_Anomaly_Detection_Starter.ipynb` — SOC-level starter notebook
- `soc_alerts.csv` — exported alerts table (generated by the notebook)

## Dataset
Columns include geo fields:
- `location`, `country`, `lat`, `lon`

Event types present: `AUTH_SUCCESS`, `AUTH_FAIL`, `FILE_READ`, `DATA_EXPORT`, `PRIV_ESCALATION`

## Expectations
Build a small "detection pipeline":

### Step 1 – Feature Engineering
- Windowed AUTH_FAIL counts (per user + IP, 10-min windows)
- Time deltas between consecutive events per user
- Geo speed between consecutive logins (haversine distance / time)

### Step 2 – Alerts with Severity Scoring
Implement all four detections:

| Detection | What it catches | Severity |
|-----------|----------------|----------|
| A – Brute Force Chain | AUTH_FAIL burst → AUTH_SUCCESS | CRITICAL |
| B – Priv Escalation | PRIV_ESCALATION after CRITICAL auth alert | CRITICAL |
| C – Impossible Travel | Login from two locations faster than possible (>900 km/h) | CRITICAL |
| D – Data Exfiltration | bytes_out z-score > 3 | HIGH / CRITICAL |

Output: an `alerts` DataFrame with columns:
`alert_type`, `severity`, `user`, `ip_address`, `start_time`, `end_time`, `evidence`

### Step 3 – SOC Analyst Narrative
Write 8–12 bullets covering:
- What happened? (timeline: first → next → last)
- Which alerts fired and why they matter
- Most severe alert with supporting evidence
- Likely attack type (e.g., credential stuffing, account takeover)
- Recommended response actions (containment + investigation)
